<html>
<head>
<title>Assignment_1.ipynb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #cf8e6d;}
.s2 { color: #bcbec4;}
.s3 { color: #7a7e85;}
.s4 { color: #6aab73;}
.s5 { color: #2aacb8;}
.ls0 { height: 1px; border-width: 0; color: #43454a; background-color:#43454a}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Assignment_1.ipynb</font>
</center></td></tr></table>
<pre><span class="s0">#%% md 
### ER-2068, Eka Tsilosani 
### ER-2067, Temur Tsomaia <hr class="ls0">#%% md 
This report uses the PuLP library to solve a production optimization problem for the Johnson &amp; Sons company. The goal is to determine the optimal production mix of six different toys to maximize weekly income, subject to constraints on machine availability and specific market-driven production ratios. <hr class="ls0">#%% md 
Let \(x_A, x_B, ..., x_F\) be the number of toys of each type to manufacture. 
 
### Objective Function 
The objective is to maximize the total income (Z): 
 
Z = 2.5x_A + 1.0x_B + 4.0x_C + 3.0x_D + 3.5x_E + 4.0x_F 
 
### Constraints 
**Machine Time Constraints (in minutes):** 
*   Machine 1: \( 4x_A + 5x_C + 2x_D + 2x_F \leq 7200 \) 
*   Machine 2: \( 4x_A + 3x_B + 4x_D + 4x_E + 2x_F \leq 3600 \) 
*   Machine 3: \( 3x_B + 2x_C + 5x_E + 1x_F \leq 4800 \) 
*   Machine 4: \( 5x_C + 4x_D + 2x_E + 1x_F \leq 7200 \) 
 
**Market Constraints:** 
*   \( x_F = 2x_A \) 
*   \( x_B = x_C \) <hr class="ls0">#%% 
</span><span class="s1">from </span><span class="s0">pulp </span><span class="s1">import </span><span class="s2">*</span>
<span class="s1">import </span><span class="s0">pandas </span><span class="s1">as </span><span class="s0">pd</span>

<span class="s3"># Initialize the Model</span>
<span class="s0">model </span><span class="s2">= </span><span class="s0">LpProblem</span><span class="s2">(</span><span class="s0">name</span><span class="s2">=</span><span class="s4">&quot;Johnson-And-Sons-Toys&quot;</span><span class="s2">, </span><span class="s0">sense</span><span class="s2">=</span><span class="s0">LpMaximize</span><span class="s2">)</span>

<span class="s3"># Define Decision Variables</span>
<span class="s0">toy_names </span><span class="s2">= [</span><span class="s4">'A'</span><span class="s2">, </span><span class="s4">'B'</span><span class="s2">, </span><span class="s4">'C'</span><span class="s2">, </span><span class="s4">'D'</span><span class="s2">, </span><span class="s4">'E'</span><span class="s2">, </span><span class="s4">'F'</span><span class="s2">]</span>
<span class="s0">x </span><span class="s2">= </span><span class="s0">LpVariable</span><span class="s2">.</span><span class="s0">dicts</span><span class="s2">(</span><span class="s4">&quot;num_toys&quot;</span><span class="s2">, </span><span class="s0">toy_names</span><span class="s2">, </span><span class="s0">lowBound</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s0">cat</span><span class="s2">=</span><span class="s4">'Continuous'</span><span class="s2">)</span>

<span class="s3"># Define Problem Data</span>
<span class="s0">machine_data </span><span class="s2">= {</span>
    <span class="s3"># Toy: [Machine1, Machine2, Machine3, Machine4] (in minutes)</span>
    <span class="s4">'A'</span><span class="s2">: [</span><span class="s5">4</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], </span><span class="s4">'B'</span><span class="s2">: [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], </span><span class="s4">'C'</span><span class="s2">: [</span><span class="s5">5</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">5</span><span class="s2">],</span>
    <span class="s4">'D'</span><span class="s2">: [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">4</span><span class="s2">], </span><span class="s4">'E'</span><span class="s2">: [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], </span><span class="s4">'F'</span><span class="s2">: [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]</span>
<span class="s2">}</span>
<span class="s0">selling_prices </span><span class="s2">= {</span><span class="s4">'A'</span><span class="s2">: </span><span class="s5">2.5</span><span class="s2">, </span><span class="s4">'B'</span><span class="s2">: </span><span class="s5">1.0</span><span class="s2">, </span><span class="s4">'C'</span><span class="s2">: </span><span class="s5">4.0</span><span class="s2">, </span><span class="s4">'D'</span><span class="s2">: </span><span class="s5">3.0</span><span class="s2">, </span><span class="s4">'E'</span><span class="s2">: </span><span class="s5">3.5</span><span class="s2">, </span><span class="s4">'F'</span><span class="s2">: </span><span class="s5">4.0</span><span class="s2">}</span>
<span class="s0">machine_availability </span><span class="s2">= {</span>
    <span class="s4">'Machine1'</span><span class="s2">: </span><span class="s5">120 </span><span class="s2">* </span><span class="s5">60</span><span class="s2">, </span><span class="s4">'Machine2'</span><span class="s2">: </span><span class="s5">60 </span><span class="s2">* </span><span class="s5">60</span><span class="s2">,</span>
    <span class="s4">'Machine3'</span><span class="s2">: </span><span class="s5">80 </span><span class="s2">* </span><span class="s5">60</span><span class="s2">, </span><span class="s4">'Machine4'</span><span class="s2">: </span><span class="s5">120 </span><span class="s2">* </span><span class="s5">60</span>
<span class="s2">}</span>

<span class="s3"># Define Objective Function</span>
<span class="s0">model </span><span class="s2">+= </span><span class="s0">lpSum</span><span class="s2">([</span><span class="s0">selling_prices</span><span class="s2">[</span><span class="s0">i</span><span class="s2">] * </span><span class="s0">x</span><span class="s2">[</span><span class="s0">i</span><span class="s2">] </span><span class="s1">for </span><span class="s0">i </span><span class="s1">in </span><span class="s0">toy_names</span><span class="s2">]), </span><span class="s4">&quot;Total_Income&quot;</span>

<span class="s3"># Define Constraints</span>
<span class="s1">for </span><span class="s0">m_idx</span><span class="s2">, </span><span class="s0">machine </span><span class="s1">in </span><span class="s0">enumerate</span><span class="s2">([</span><span class="s4">'Machine1'</span><span class="s2">, </span><span class="s4">'Machine2'</span><span class="s2">, </span><span class="s4">'Machine3'</span><span class="s2">, </span><span class="s4">'Machine4'</span><span class="s2">]):</span>
    <span class="s0">model </span><span class="s2">+= </span><span class="s0">lpSum</span><span class="s2">([</span><span class="s0">machine_data</span><span class="s2">[</span><span class="s0">toy</span><span class="s2">][</span><span class="s0">m_idx</span><span class="s2">] * </span><span class="s0">x</span><span class="s2">[</span><span class="s0">toy</span><span class="s2">] </span><span class="s1">for </span><span class="s0">toy </span><span class="s1">in </span><span class="s0">toy_names</span><span class="s2">]) &lt;= </span><span class="s0">machine_availability</span><span class="s2">[</span><span class="s0">machine</span><span class="s2">], </span><span class="s4">f&quot;</span><span class="s1">{</span><span class="s0">machine</span><span class="s1">}</span><span class="s4">_Constraint&quot;</span>
<span class="s0">model </span><span class="s2">+= </span><span class="s0">x</span><span class="s2">[</span><span class="s4">'F'</span><span class="s2">] == </span><span class="s5">2 </span><span class="s2">* </span><span class="s0">x</span><span class="s2">[</span><span class="s4">'A'</span><span class="s2">], </span><span class="s4">&quot;Ratio_F_to_A&quot;</span>
<span class="s0">model </span><span class="s2">+= </span><span class="s0">x</span><span class="s2">[</span><span class="s4">'B'</span><span class="s2">] == </span><span class="s0">x</span><span class="s2">[</span><span class="s4">'C'</span><span class="s2">], </span><span class="s4">&quot;Ratio_B_to_C&quot;</span>

<span class="s3"># Explicit solver command for reproducibility</span>
<span class="s0">model</span><span class="s2">.</span><span class="s0">solve</span><span class="s2">(</span><span class="s0">PULP_CBC_CMD</span><span class="s2">(</span><span class="s0">msg</span><span class="s2">=</span><span class="s1">False</span><span class="s2">))</span>

<span class="s3"># Solve the Model</span>
<span class="s0">model</span><span class="s2">.</span><span class="s0">solve</span><span class="s2">()</span>

<span class="s3"># Print the results for the report</span>
<span class="s0">print</span><span class="s2">(</span><span class="s4">f&quot;Status: </span><span class="s1">{</span><span class="s0">LpStatus</span><span class="s2">[</span><span class="s0">model</span><span class="s2">.</span><span class="s0">status</span><span class="s2">]</span><span class="s1">}</span><span class="s4">&quot;</span><span class="s2">)</span><hr class="ls0"><span class="s0">#%% md 
## 3. Results and Analysis 
 
The model found an optimal solution to the production problem. 
 
### The Number of Toys to Manufacture 
The optimal number of each toy to produce per week is: <hr class="ls0">#%% 
</span><span class="s1">for </span><span class="s0">toy </span><span class="s1">in </span><span class="s0">toy_names</span><span class="s2">:</span>
    <span class="s0">print</span><span class="s2">(</span><span class="s4">f&quot;- Toy </span><span class="s1">{</span><span class="s0">toy</span><span class="s1">}</span><span class="s4">: </span><span class="s1">{</span><span class="s0">x</span><span class="s2">[</span><span class="s0">toy</span><span class="s2">].</span><span class="s0">value</span><span class="s2">()</span><span class="s1">:</span><span class="s4">.2f</span><span class="s1">} </span><span class="s4">units&quot;</span><span class="s2">)</span><hr class="ls0"><span class="s0">#%% 
df </span><span class="s2">= </span><span class="s0">pd</span><span class="s2">.</span><span class="s0">DataFrame</span><span class="s2">({</span>
    <span class="s4">'Toy'</span><span class="s2">: </span><span class="s0">toy_names</span><span class="s2">,</span>
    <span class="s4">'Quantity'</span><span class="s2">: [</span><span class="s0">x</span><span class="s2">[</span><span class="s0">t</span><span class="s2">].</span><span class="s0">value</span><span class="s2">() </span><span class="s1">for </span><span class="s0">t </span><span class="s1">in </span><span class="s0">toy_names</span><span class="s2">],</span>
    <span class="s4">'Price (USD)'</span><span class="s2">: [</span><span class="s0">selling_prices</span><span class="s2">[</span><span class="s0">t</span><span class="s2">] </span><span class="s1">for </span><span class="s0">t </span><span class="s1">in </span><span class="s0">toy_names</span><span class="s2">],</span>
    <span class="s4">'Income (USD)'</span><span class="s2">: [</span><span class="s0">selling_prices</span><span class="s2">[</span><span class="s0">t</span><span class="s2">]*</span><span class="s0">x</span><span class="s2">[</span><span class="s0">t</span><span class="s2">].</span><span class="s0">value</span><span class="s2">() </span><span class="s1">for </span><span class="s0">t </span><span class="s1">in </span><span class="s0">toy_names</span><span class="s2">]</span>
<span class="s2">})</span>
<span class="s0">df</span><span class="s2">.</span><span class="s0">loc</span><span class="s2">[</span><span class="s4">'Total'</span><span class="s2">] = [</span><span class="s4">'—'</span><span class="s2">, </span><span class="s4">''</span><span class="s2">, </span><span class="s4">''</span><span class="s2">, </span><span class="s0">df</span><span class="s2">[</span><span class="s4">'Income (USD)'</span><span class="s2">].</span><span class="s0">sum</span><span class="s2">()]</span>
<span class="s0">display</span><span class="s2">(</span><span class="s0">df</span><span class="s2">)</span>

<span class="s3"># total income printout</span>
<span class="s0">print</span><span class="s2">(</span><span class="s4">f&quot;</span><span class="s1">\n</span><span class="s4">Total Maximized Income : $</span><span class="s1">{</span><span class="s0">model</span><span class="s2">.</span><span class="s0">objective</span><span class="s2">.</span><span class="s0">value</span><span class="s2">()</span><span class="s1">:</span><span class="s4">.2f</span><span class="s1">}</span><span class="s4">&quot;</span><span class="s2">)</span><hr class="ls0"><span class="s0">#%% 
</span><span class="s3"># machine utilization summary with slack and %</span>
<span class="s0">machine_summary </span><span class="s2">= []</span>
<span class="s1">for </span><span class="s0">m_idx</span><span class="s2">, </span><span class="s0">machine </span><span class="s1">in </span><span class="s0">enumerate</span><span class="s2">([</span><span class="s4">'Machine1'</span><span class="s2">, </span><span class="s4">'Machine2'</span><span class="s2">, </span><span class="s4">'Machine3'</span><span class="s2">, </span><span class="s4">'Machine4'</span><span class="s2">]):</span>
    <span class="s0">used </span><span class="s2">= </span><span class="s0">sum</span><span class="s2">(</span><span class="s0">machine_data</span><span class="s2">[</span><span class="s0">toy</span><span class="s2">][</span><span class="s0">m_idx</span><span class="s2">] * </span><span class="s0">x</span><span class="s2">[</span><span class="s0">toy</span><span class="s2">].</span><span class="s0">value</span><span class="s2">() </span><span class="s1">for </span><span class="s0">toy </span><span class="s1">in </span><span class="s0">toy_names</span><span class="s2">)</span>
    <span class="s0">limit </span><span class="s2">= </span><span class="s0">machine_availability</span><span class="s2">[</span><span class="s0">machine</span><span class="s2">]</span>
    <span class="s0">slack </span><span class="s2">= </span><span class="s0">limit </span><span class="s2">- </span><span class="s0">used</span>
    <span class="s0">utilization </span><span class="s2">= </span><span class="s0">used </span><span class="s2">/ </span><span class="s0">limit </span><span class="s2">* </span><span class="s5">100</span>
    <span class="s0">machine_summary</span><span class="s2">.</span><span class="s0">append</span><span class="s2">([</span><span class="s0">machine</span><span class="s2">, </span><span class="s0">used</span><span class="s2">, </span><span class="s0">limit</span><span class="s2">, </span><span class="s0">slack</span><span class="s2">, </span><span class="s0">utilization</span><span class="s2">])</span>

<span class="s0">util_df </span><span class="s2">= </span><span class="s0">pd</span><span class="s2">.</span><span class="s0">DataFrame</span><span class="s2">(</span><span class="s0">machine_summary</span><span class="s2">, </span><span class="s0">columns</span><span class="s2">=[</span><span class="s4">'Machine'</span><span class="s2">, </span><span class="s4">'Used (min)'</span><span class="s2">, </span><span class="s4">'Capacity (min)'</span><span class="s2">, </span><span class="s4">'Slack (min)'</span><span class="s2">, </span><span class="s4">'Utilization (%)'</span><span class="s2">])</span>
<span class="s0">display</span><span class="s2">(</span><span class="s0">util_df</span><span class="s2">)</span><hr class="ls0"><span class="s0">#%% md 
### Binding (Fully Utilized) Machines: <hr class="ls0">#%% 
</span><span class="s1">for </span><span class="s0">_</span><span class="s2">, </span><span class="s0">row </span><span class="s1">in </span><span class="s0">util_df</span><span class="s2">.</span><span class="s0">iterrows</span><span class="s2">():</span>
    <span class="s1">if </span><span class="s0">abs</span><span class="s2">(</span><span class="s0">row</span><span class="s2">[</span><span class="s4">'Slack (min)'</span><span class="s2">]) &lt; </span><span class="s5">1e-5</span><span class="s2">:</span>
        <span class="s0">print</span><span class="s2">(</span><span class="s4">f&quot;- </span><span class="s1">{</span><span class="s0">row</span><span class="s2">[</span><span class="s4">'Machine'</span><span class="s2">]</span><span class="s1">} </span><span class="s4">(100% utilized)&quot;</span><span class="s2">)</span>
    <span class="s1">else</span><span class="s2">:</span>
        <span class="s0">print</span><span class="s2">(</span><span class="s4">f&quot;- </span><span class="s1">{</span><span class="s0">row</span><span class="s2">[</span><span class="s4">'Machine'</span><span class="s2">]</span><span class="s1">} </span><span class="s4">has </span><span class="s1">{</span><span class="s0">row</span><span class="s2">[</span><span class="s4">'Slack (min)'</span><span class="s2">]</span><span class="s1">:</span><span class="s4">.2f</span><span class="s1">} </span><span class="s4">min slack (</span><span class="s1">{</span><span class="s5">100 </span><span class="s2">- </span><span class="s0">row</span><span class="s2">[</span><span class="s4">'Utilization (%)'</span><span class="s2">]</span><span class="s1">:</span><span class="s4">.2f</span><span class="s1">}</span><span class="s4">% free)&quot;</span><span class="s2">)</span>
<hr class="ls0"><span class="s0">#%% md 
### Production Time Required on Each Machine (Minutes) : <hr class="ls0">#%% 
</span><span class="s1">for </span><span class="s0">m_idx</span><span class="s2">, </span><span class="s0">machine </span><span class="s1">in </span><span class="s0">enumerate</span><span class="s2">([</span><span class="s4">'Machine1'</span><span class="s2">, </span><span class="s4">'Machine2'</span><span class="s2">, </span><span class="s4">'Machine3'</span><span class="s2">, </span><span class="s4">'Machine4'</span><span class="s2">]):</span>

    <span class="s0">used_time </span><span class="s2">= </span><span class="s0">sum</span><span class="s2">(</span><span class="s0">machine_data</span><span class="s2">[</span><span class="s0">toy</span><span class="s2">][</span><span class="s0">m_idx</span><span class="s2">] * </span><span class="s0">x</span><span class="s2">[</span><span class="s0">toy</span><span class="s2">].</span><span class="s0">value</span><span class="s2">() </span><span class="s1">for </span><span class="s0">toy </span><span class="s1">in </span><span class="s0">toy_names</span><span class="s2">)</span>
    <span class="s0">limit </span><span class="s2">= </span><span class="s0">machine_availability</span><span class="s2">[</span><span class="s0">machine</span><span class="s2">]</span>
    <span class="s0">slack </span><span class="s2">= </span><span class="s0">limit </span><span class="s2">- </span><span class="s0">used_time</span>
    <span class="s0">print</span><span class="s2">(</span><span class="s4">f&quot;- **</span><span class="s1">{</span><span class="s0">machine</span><span class="s1">}</span><span class="s4">:** </span><span class="s1">{</span><span class="s0">used_time</span><span class="s1">:</span><span class="s4">.2f</span><span class="s1">} </span><span class="s4">used / </span><span class="s1">{</span><span class="s0">limit</span><span class="s1">} </span><span class="s4">limit (Slack: </span><span class="s1">{</span><span class="s0">slack</span><span class="s1">:</span><span class="s4">.2f</span><span class="s1">}</span><span class="s4">)&quot;</span><span class="s2">)</span><hr class="ls0"><span class="s0">#%% md 
### Partial Income by Toy : <hr class="ls0">#%% 
</span><span class="s1">for </span><span class="s0">toy </span><span class="s1">in </span><span class="s0">toy_names</span><span class="s2">:</span>
    <span class="s0">income </span><span class="s2">= </span><span class="s0">selling_prices</span><span class="s2">[</span><span class="s0">toy</span><span class="s2">] * </span><span class="s0">x</span><span class="s2">[</span><span class="s0">toy</span><span class="s2">].</span><span class="s0">value</span><span class="s2">()</span>
    <span class="s0">print</span><span class="s2">(</span><span class="s4">f&quot;- **Toy </span><span class="s1">{</span><span class="s0">toy</span><span class="s1">}</span><span class="s4">:** $</span><span class="s1">{</span><span class="s0">income</span><span class="s1">:</span><span class="s4">.2f</span><span class="s1">}</span><span class="s4">&quot;</span><span class="s2">)</span><hr class="ls0"><span class="s0">#%% md 
The total maximized income is: <hr class="ls0">#%% 
print</span><span class="s2">(</span><span class="s4">f&quot;$</span><span class="s1">{</span><span class="s0">model</span><span class="s2">.</span><span class="s0">objective</span><span class="s2">.</span><span class="s0">value</span><span class="s2">()</span><span class="s1">:</span><span class="s4">.2f</span><span class="s1">}</span><span class="s4">&quot;</span><span class="s2">)</span><hr class="ls0"><span class="s0">#%% md 
## Answer Of The Questions 
 
#### Which toy(s) production should be focused on? 
Production should be focused on **Toys C, B, and F**. They generate the most income in the optimal solution. 
 
#### Is there a toy that can be excluded from consideration for production? 
Yes, **Toy D and Toy E** . The optimal solution is to produce 0 units of both D and E, meaning their resources are better used on other, more profitable toys. 
 
#### Is there a machine that is not fully utilized? 
Yes, Machines 1 and 4 are not fully utilized (Slack &gt; 0). **Machines 2 and 3 are the bottlenecks** , running at 100% capacity and limiting further production. 
 
### Sensitivity insight 
Machine 2 and 3 constraints are binding — increasing their availability would increase income and producing more of toy F or C would be most beneficial if machine limits are relaxed. 
 
 
#### github - https://github.com/tsilosanieka/OR/blob/main/Assignment_1.ipynb 
</span></pre>
</body>
</html>